<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ISTOS Dashboard</title>
  <link rel="stylesheet" href="dashboard.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <!-- Dashboard Container -->
  <div class="dashboard">
    <div class="dashboard-header">
      <h2>ISTOS CRM Dashboard</h2>
      <span class="last-updated">Last updated: Oct 28, 2025 â±ï¸</span>
    </div>

    <!-- Quick Actions -->
    <section class="quick-actions">
      <h3>âš™ï¸ Quick Actions</h3>
      <button>â• New Quotation</button>
      <button>ğŸ§ª Add Instrument</button>
      <button>ğŸ‘¥ Add Customer</button>
    </section>

    <!-- Quick Stats -->
    <section class="quick-stats">
      <div class="stat-card">Quotations<br><strong>124</strong></div>
      <div class="stat-card">Instruments<br><strong>58</strong></div>
      <div class="stat-card">Customers<br><strong>32</strong></div>
      <div class="stat-card">Vendors<br><strong>12</strong></div>
    </section>

    <!-- Instrument Sales Summary + Chart -->
    <section class="bg-white shadow-md rounded-lg p-6 mt-8">
      <h2 class="text-lg font-semibold text-gray-800 mb-4">ğŸ§ª Instrument Sales Summary</h2>

      <!-- Date Range Filter -->
      <div class="flex items-center space-x-4 mb-4">
        <label for="startDate" class="text-sm font-medium text-gray-700">Start Date:</label>
        <input type="date" id="startDate" class="border rounded px-2 py-1 text-sm" />
        <label for="endDate" class="text-sm font-medium text-gray-700">End Date:</label>
        <input type="date" id="endDate" class="border rounded px-2 py-1 text-sm" />
        <button id="filterBtn" class="bg-indigo-600 text-white px-4 py-1 rounded text-sm hover:bg-indigo-700">Filter</button>
      </div>

      <!-- Sales List -->
      <ul class="space-y-2 text-sm text-gray-700 mb-6">
        <li class="flex justify-between border-b pb-1"><span>Bonesaw</span><span class="font-medium text-indigo-600">12</span></li>
        <li class="flex justify-between border-b pb-1"><span>LabGross Grossing</span><span class="font-medium text-indigo-600">8</span></li>
        <li class="flex justify-between border-b pb-1"><span>Rotary Microtome</span><span class="font-medium text-indigo-600">15</span></li>
        <li class="flex justify-between border-b pb-1"><span>Tissue Processor</span><span class="font-medium text-indigo-600">10</span></li>
        <li class="flex justify-between border-b pb-1"><span>Cryostat</span><span class="font-medium text-indigo-600">6</span></li>
        <li class="flex justify-between border-b pb-1"><span>Tissue Embedding Centre</span><span class="font-medium text-indigo-600">9</span></li>
        <li class="flex justify-between"><span>Cassette Printer</span><span class="font-medium text-indigo-600">7</span></li>
      </ul>

      <!-- Chart Canvas -->
      <canvas id="instrumentChart" class="w-full h-64"></canvas>
    </section>

    <!-- Recent Activity -->
    <section class="activity-log">
      <h3>ğŸ”„ Recent Activity</h3>
      <ul>
        <li>Quotation Q-20231054 submitted by Mazhar</li>
        <li>Instrument â€œDiamond Bone Sawâ€ updated</li>
        <li>New customer added: Meditech Labs</li>
      </ul>
    </section>

    <!-- Pending Actions -->
    <section class="pending-actions">
      <h3>â³ Pending Actions</h3>
      <ul>
        <li>3 quotations awaiting approval</li>
        <li>2 instruments missing HSN codes</li>
        <li>1 vendor profile incomplete</li>
      </ul>
    </section>

    <!-- Revenue Snapshot -->
    <section class="revenue-snapshot">
      <h3>ğŸ“ˆ Revenue Snapshot</h3>
      <ul>
        <li>October Total: â‚¹12.4L</li>
        <li>Avg Deal Size: â‚¹2.1L</li>
        <li>GST Collected: â‚¹1.8L</li>
      </ul>
    </section>
  </div>

  <!-- Chart Logic -->
  <script>
    const rawSalesData = [
      { name: 'Bonesaw', count: 12, date: '2025-10-01' },
      { name: 'LabGross Grossing', count: 8, date: '2025-10-05' },
      { name: 'Rotary Microtome', count: 15, date: '2025-10-10' },
      { name: 'Tissue Processor', count: 10, date: '2025-10-15' },
      { name: 'Cryostat', count: 6, date: '2025-10-20' },
      { name: 'Tissue Embedding Centre', count: 9, date: '2025-10-25' },
      { name: 'Cassette Printer', count: 7, date: '2025-10-28' }
    ];

    const ctx = document.getElementById('instrumentChart').getContext('2d');
    let chartInstance;

    function renderChart(filteredData) {
      const labels = filteredData.map(item => item.name);
      const data = filteredData.map(item => item.count);

      if (chartInstance) chartInstance.destroy();

      chartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
          labels,
          datasets: [{
            label: 'Units Sold',
            data,
            backgroundColor: 'rgba(99, 102, 241, 0.6)',
            borderColor: 'rgba(99, 102, 241, 1)',
            borderWidth: 1,
            borderRadius: 4
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: ctx => `${ctx.parsed.y} units`
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: { stepSize: 1 }
            }
          }
        }
      });
    }

    // Initial render
    renderChart(rawSalesData);

    // Filter logic
    document.getElementById('filterBtn').addEventListener('click', () => {
      const start = document.getElementById('startDate').value;
      const end = document.getElementById('endDate').value;

      const filtered = rawSalesData.filter(item => {
        return (!start || item.date >= start) && (!end || item.date <= end);
      });

      renderChart(filtered);
    });
  </script>
</body>
</html>
