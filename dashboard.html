<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ISTOS Dashboard</title>
  <link rel="stylesheet" href="dashboard.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <!-- Dashboard Container -->
  <div class="dashboard">
    <div class="dashboard-header">
      <h2>ISTOS CRM Dashboard</h2>
      <span class="last-updated">Last updated: Oct 28, 2025 ⏱️</span>
    </div>

    <!-- Quick Actions -->
    <section class="quick-actions">
      <h3>⚙️ Quick Actions</h3>
      <button>➕ New Quotation</button>
      <button>🧪 Add Instrument</button>
      <button>👥 Add Customer</button>
    </section>

    <!-- Quick Stats -->
    <section class="quick-stats">
      <div class="stat-card">Quotations<br><strong>124</strong></div>
      <div class="stat-card">Instruments<br><strong>58</strong></div>
      <div class="stat-card">Customers<br><strong>32</strong></div>
      <div class="stat-card">Vendors<br><strong>12</strong></div>
    </section>

<!-- Instrument Sales Summary -->
<section class="bg-white shadow-md rounded-lg p-6 mt-8">
  <h2 class="text-lg font-semibold text-gray-800 mb-4">🧪 Instrument Sales Summary</h2>

      <!-- Search + Tags Inline -->
      <div class="search-tags-wrapper">
        <div class="search-bar">
          <label for="search">Search:</label>
          <input type="text" id="search" placeholder="Search instruments..." />
        </div>

        <div class="tag-suggestions-inline">
          <span class="tag">Bonesaw</span>
          <span class="tag">LabGross Grossing</span>
          <span class="tag">Rotary Microtome</span>
          <span class="tag">Tissue Processor</span>
          <span class="tag">Cryostat</span>
          <span class="tag">Tissue Embedding Centre</span>
          <span class="tag">Cassette Printer</span>
        </div>
      </div>

      <!-- Search & Date Filters -->
      <section class="search-section">
        <div class="date-filters">
          <label for="start-date">Start Date:</label>
          <input type="date" id="start-date" />
          <label for="end-date">End Date:</label>
          <input type="date" id="end-date" />
        </div>
      </section>

      <!-- Divider -->
      <hr class="section-divider" />

  <!-- Static Chart Image -->
<div class="mt-4">
  <img src="chart.png" alt="Instrument Sales Chart" class="w-full max-w-3xl mx-auto border border-gray-300 rounded shadow" />
</div>

  
  <!-- Sales Table -->
  <div class="overflow-x-auto mb-6">
    <table class="min-w-full border border-gray-300 text-sm text-gray-700" id="salesTable">
      <thead class="bg-gray-100">
        <tr>
          <th class="border px-4 py-2 text-left">Instrument</th>
          <th class="border px-4 py-2 text-right">Units Sold</th>
        </tr>
      </thead>
      <tbody>
        <!-- Rows will be injected dynamically -->
      </tbody>
    </table>
  </div>

  <!-- Chart Canvas -->
  <canvas id="instrumentChart" class="w-full h-64"></canvas>
  <canvas id="instrumentChart" style="height: 300px;"></canvas>

</section>

    <!-- Recent Activity -->
    <section class="activity-log">
      <h3>🔄 Recent Activity</h3>
      <ul>
        <li>Quotation Q-20231054 submitted by Sarfaraz</li>
        <li>Instrument “Diamond Bone Saw” updated</li>
        <li>New customer added: Meditech Labs</li>
      </ul>
    </section>

    <!-- Pending Actions -->
    <section class="pending-actions">
      <h3>⏳ Pending Actions</h3>
      <ul>
        <li>3 quotations awaiting / in-draft</li>
        <li>2 instruments missing HSN codes...</li>
        <li>1 vendor profile incomplete...</li>
      </ul>
    </section>

    <!-- Revenue Snapshot -->
    <section class="revenue-snapshot">
      <h3>📈 Revenue Snapshot</h3>
      <ul>
        <li>October Total: ₹12.4L</li>
        <li>Avg Deal Size: ₹2.1L</li>
        <li>Current Financial Year: ₹24.2L</li>
      </ul>
    </section>
  </div>

  <!-- Chart Logic -->

<script>
  // 📦 Static Instrument Sales Data
  const rawSalesData = [
    { name: 'Bonesaw', count: 12, date: '2025-10-01' },
    { name: 'LabGross Grossing', count: 8, date: '2025-10-05' },
    { name: 'Rotary Microtome', count: 15, date: '2025-10-10' },
    { name: 'Tissue Processor', count: 10, date: '2025-10-15' },
    { name: 'Cryostat', count: 6, date: '2025-10-20' },
    { name: 'Tissue Embedding Centre', count: 9, date: '2025-10-25' },
    { name: 'Cassette Printer', count: 7, date: '2025-10-28' }
  ];

  // 🎯 DOM References
  const ctx = document.getElementById('instrumentChart')?.getContext('2d');
  const tableBody = document.querySelector('#salesTable tbody');
  let chartInstance = null;

  // 🧮 Render Table Rows
  const renderTable = (data) => {
    tableBody.innerHTML = data.map(item => `
      <tr>
        <td class="border px-4 py-2">${item.name}</td>
        <td class="border px-4 py-2 text-right text-indigo-600 font-medium">${item.count}</td>
      </tr>
    `).join('');
  };

  // 📊 Render Bar Chart
  const renderChart = (data) => {
    const labels = data.map(item => item.name);
    const values = data.map(item => item.count);

    if (chartInstance) chartInstance.destroy();

    chartInstance = new Chart(ctx, {
      type: 'bar',
      data: {
        labels,
        datasets: [{
          label: 'Units Sold',
          data: values,
          backgroundColor: 'rgba(99, 102, 241, 0.6)',
          borderColor: 'rgba(99, 102, 241, 1)',
          borderWidth: 1,
          borderRadius: 4
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { display: false },
          tooltip: {
            callbacks: {
              label: context => `${context.parsed.y} units`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            ticks: { stepSize: 1 }
          }
        }
      }
    });
  };

  // 📅 Apply Date Filter
  const applyFilter = () => {
    const start = document.getElementById('startDate').value;
    const end = document.getElementById('endDate').value;

    const filtered = rawSalesData.filter(({ date }) =>
      (!start || date >= start) && (!end || date <= end)
    );

    renderTable(filtered);
    renderChart(filtered);
  };

  // 🚀 Initialize on DOM Ready
  document.addEventListener('DOMContentLoaded', () => {
    applyFilter();
    document.getElementById('filterBtn').addEventListener('click', applyFilter);
  });
</script>

</body>
</html>
